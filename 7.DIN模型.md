阿里2018年提出的基于Atteingion机制的CTR DNN模型。

#### 背景

对于性别，年龄这种类别，可以通过One-Hot进行编码，但是类似于历史行为（历史商品列表）这种多值类别，编码后并不是只有一个位置为1。

多值类别的属性在Embedding后会有多个向量，传统的CTR一般会把这种池化（求和或者平均），文章认为这种操作会损失大量信息。

#### DIN解决方案

![](C:\Users\Lunus\Desktop\推荐系统\图\DIN架构图.jpg)

- 左边是传统的模型，先把向量0-1编码，然后通过Embedding层，由于每个用户的历史行为长度不同，需要通过一个Pooling得到新的Embedding表示。

- DIN则是在Embedding后，利用用户行为和广告求出权重向量，接着加权求和，同时权重不经过softmax

  对于用户U，和一个广告A，假设用户U的历史行为中包含H个商品。a是一个神经网络。如图最右边。
  $$
  v_U(A)=f(v_A,e_1,e_2,...,e_H)=\sum_{j=1}^Ha(e_j,v_A)e_j=\sum_{j=1}^Hw_je_j
  $$

- 最后接一个MLP来处理。



